{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { useContext, useEffect, useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { BarCodeScanner } from \"expo-barcode-scanner\";\nimport { router } from \"expo-router\";\nimport Icon from \"@expo/vector-icons/FontAwesome5\";\nimport ScannerFrame from \"../components/ScannerFrame\";\nimport axios from \"../axios\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Scanner() {\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user;\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      stopAnimation = _useState2[0],\n      setStopAnimation = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      hasPermission = _useState4[0],\n      setHasPermission = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      scanned = _useState6[0],\n      setScanned = _useState6[1];\n\n  useEffect(function () {\n    var requestCameraPermission = function () {\n      var _ref = _asyncToGenerator(function* () {\n        var _yield$BarCodeScanner = yield BarCodeScanner.requestPermissionsAsync(),\n            status = _yield$BarCodeScanner.status;\n\n        setHasPermission(status === \"granted\");\n      });\n\n      return function requestCameraPermission() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    requestCameraPermission();\n  }, []);\n\n  var handleBarCodeScanned = function () {\n    var _ref3 = _asyncToGenerator(function* (_ref2) {\n      var type = _ref2.type,\n          data = _ref2.data;\n      setScanned(true);\n\n      var _JSON$parse = JSON.parse(data),\n          canteenId = _JSON$parse.canteenId,\n          secret = _JSON$parse.secret;\n\n      yield axios.post(\"/auth/user/saveCanteens/\" + canteenId, {\n        userId: user._id\n      });\n\n      if (secret == \"my-canteen\") {\n        router.push({\n          pathname: \"/canteen/\" + canteenId,\n          params: {\n            canteenId: canteenId\n          }\n        });\n      }\n    });\n\n    return function handleBarCodeScanned(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsxs(View, {\n      style: {\n        display: \"flex\",\n        flexDirection: \"row\",\n        paddingHorizontal: 10,\n        alignItems: \"center\"\n      },\n      children: [_jsx(TouchableOpacity, {\n        style: {\n          width: \"20%\"\n        },\n        onPress: function onPress() {\n          router.replace(\"/\");\n          setStopAnimation(true);\n        },\n        children: _jsx(Icon, {\n          name: \"arrow-left\",\n          size: 15,\n          color: \"black\"\n        })\n      }), _jsx(Text, {\n        style: {\n          textAlign: \"center\",\n          width: \"60%\",\n          fontSize: 20,\n          fontWeight: 600\n        },\n        children: \"Scan QR code\"\n      })]\n    }), _jsxs(View, {\n      style: {\n        position: \"relative\",\n        marginTop: 40\n      },\n      children: [_jsx(ScannerFrame, _objectSpread({}, stopAnimation)), _jsx(BarCodeScanner, {\n        onBarCodeScanned: scanned ? undefined : handleBarCodeScanned,\n        style: [StyleSheet.absoluteFillObject, {\n          height: 500,\n          borderRadius: 20\n        }]\n      })]\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"white\",\n    paddingTop: 40,\n    display: \"flex\"\n  }\n});","map":{"version":3,"names":["useContext","useEffect","useState","BarCodeScanner","router","Icon","ScannerFrame","axios","AuthContext","Scanner","user","stopAnimation","setStopAnimation","hasPermission","setHasPermission","scanned","setScanned","requestCameraPermission","requestPermissionsAsync","status","handleBarCodeScanned","type","data","JSON","parse","canteenId","secret","post","userId","_id","push","pathname","params","styles","container","display","flexDirection","paddingHorizontal","alignItems","width","replace","textAlign","fontSize","fontWeight","position","marginTop","undefined","StyleSheet","absoluteFillObject","height","borderRadius","create","flex","backgroundColor","paddingTop"],"sources":["C:/Users/hello/OneDrive/Desktop/React-native/canteen-project/client/app/scanner.js"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\r\nimport { StyleSheet, Text, View, TouchableOpacity } from \"react-native\";\r\nimport { BarCodeScanner } from \"expo-barcode-scanner\";\r\nimport { router } from \"expo-router\";\r\nimport Icon from \"react-native-vector-icons/FontAwesome5\";\r\nimport ScannerFrame from \"../components/ScannerFrame\";\r\nimport axios from \"../axios\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\n\r\nexport default function Scanner() {\r\n  const { user } = useContext(AuthContext);\r\n  const [stopAnimation, setStopAnimation] = useState();\r\n  const [hasPermission, setHasPermission] = useState(null);\r\n  const [scanned, setScanned] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const requestCameraPermission = async () => {\r\n      const { status } = await BarCodeScanner.requestPermissionsAsync();\r\n      setHasPermission(status === \"granted\");\r\n    };\r\n\r\n    requestCameraPermission();\r\n  }, []);\r\n\r\n  const handleBarCodeScanned = async ({ type, data }) => {\r\n    setScanned(true);\r\n\r\n    const { canteenId, secret } = JSON.parse(data);\r\n    await axios.post(`/auth/user/saveCanteens/${canteenId}`, {\r\n      userId: user._id,\r\n    });\r\n\r\n    if (secret == \"my-canteen\") {\r\n      router.push({\r\n        pathname: `/canteen/${canteenId}`,\r\n        params: { canteenId },\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View\r\n        style={{\r\n          display: \"flex\",\r\n          flexDirection: \"row\",\r\n          paddingHorizontal: 10,\r\n          alignItems: \"center\",\r\n        }}\r\n      >\r\n        <TouchableOpacity\r\n          style={{ width: \"20%\" }}\r\n          onPress={() => {\r\n            router.replace(\"/\");\r\n            setStopAnimation(true);\r\n          }}\r\n        >\r\n          <Icon name=\"arrow-left\" size={15} color=\"black\" />\r\n        </TouchableOpacity>\r\n        <Text\r\n          style={{\r\n            textAlign: \"center\",\r\n            width: \"60%\",\r\n            fontSize: 20,\r\n            fontWeight: 600,\r\n          }}\r\n        >\r\n          Scan QR code\r\n        </Text>\r\n      </View>\r\n      <View style={{ position: \"relative\", marginTop: 40 }}>\r\n        <ScannerFrame {...stopAnimation} />\r\n        <BarCodeScanner\r\n          onBarCodeScanned={scanned ? undefined : handleBarCodeScanned}\r\n          style={[\r\n            StyleSheet.absoluteFillObject,\r\n            { height: 500, borderRadius: 20 },\r\n          ]}\r\n        />\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: \"white\",\r\n    paddingTop: 40,\r\n    display: \"flex\",\r\n  },\r\n});\r\n"],"mappings":";;;;;;;;AAAA,SAASA,UAAT,EAAqBC,SAArB,EAAgCC,QAAhC,QAAgD,OAAhD;;;;;AAEA,SAASC,cAAT,QAA+B,sBAA/B;AACA,SAASC,MAAT,QAAuB,aAAvB;AACA,OAAOC,IAAP;AACA,OAAOC,YAAP;AACA,OAAOC,KAAP;AACA,SAASC,WAAT;;;AAEA,eAAe,SAASC,OAAT,GAAmB;EAChC,kBAAiBT,UAAU,CAACQ,WAAD,CAA3B;EAAA,IAAQE,IAAR,eAAQA,IAAR;;EACA,gBAA0CR,QAAQ,EAAlD;EAAA;EAAA,IAAOS,aAAP;EAAA,IAAsBC,gBAAtB;;EACA,iBAA0CV,QAAQ,CAAC,IAAD,CAAlD;EAAA;EAAA,IAAOW,aAAP;EAAA,IAAsBC,gBAAtB;;EACA,iBAA8BZ,QAAQ,CAAC,KAAD,CAAtC;EAAA;EAAA,IAAOa,OAAP;EAAA,IAAgBC,UAAhB;;EAEAf,SAAS,CAAC,YAAM;IACd,IAAMgB,uBAAuB;MAAA,6BAAG,aAAY;QAC1C,kCAAyBd,cAAc,CAACe,uBAAf,EAAzB;QAAA,IAAQC,MAAR,yBAAQA,MAAR;;QACAL,gBAAgB,CAACK,MAAM,KAAK,SAAZ,CAAhB;MACD,CAH4B;;MAAA,gBAAvBF,uBAAuB;QAAA;MAAA;IAAA,GAA7B;;IAKAA,uBAAuB;EACxB,CAPQ,EAON,EAPM,CAAT;;EASA,IAAMG,oBAAoB;IAAA,8BAAG,kBAA0B;MAAA,IAAjBC,IAAiB,SAAjBA,IAAiB;MAAA,IAAXC,IAAW,SAAXA,IAAW;MACrDN,UAAU,CAAC,IAAD,CAAV;;MAEA,kBAA8BO,IAAI,CAACC,KAAL,CAAWF,IAAX,CAA9B;MAAA,IAAQG,SAAR,eAAQA,SAAR;MAAA,IAAmBC,MAAnB,eAAmBA,MAAnB;;MACA,MAAMnB,KAAK,CAACoB,IAAN,8BAAsCF,SAAtC,EAAmD;QACvDG,MAAM,EAAElB,IAAI,CAACmB;MAD0C,CAAnD,CAAN;;MAIA,IAAIH,MAAM,IAAI,YAAd,EAA4B;QAC1BtB,MAAM,CAAC0B,IAAP,CAAY;UACVC,QAAQ,gBAAcN,SADZ;UAEVO,MAAM,EAAE;YAAEP,SAAS,EAATA;UAAF;QAFE,CAAZ;MAID;IACF,CAdyB;;IAAA,gBAApBL,oBAAoB;MAAA;IAAA;EAAA,GAA1B;;EAgBA,OACE,MAAC,IAAD;IAAM,KAAK,EAAEa,MAAM,CAACC,SAApB;IAAA,WACE,MAAC,IAAD;MACE,KAAK,EAAE;QACLC,OAAO,EAAE,MADJ;QAELC,aAAa,EAAE,KAFV;QAGLC,iBAAiB,EAAE,EAHd;QAILC,UAAU,EAAE;MAJP,CADT;MAAA,WAQE,KAAC,gBAAD;QACE,KAAK,EAAE;UAAEC,KAAK,EAAE;QAAT,CADT;QAEE,OAAO,EAAE,mBAAM;UACbnC,MAAM,CAACoC,OAAP,CAAe,GAAf;UACA5B,gBAAgB,CAAC,IAAD,CAAhB;QACD,CALH;QAAA,UAOE,KAAC,IAAD;UAAM,IAAI,EAAC,YAAX;UAAwB,IAAI,EAAE,EAA9B;UAAkC,KAAK,EAAC;QAAxC;MAPF,EARF,EAiBE,KAAC,IAAD;QACE,KAAK,EAAE;UACL6B,SAAS,EAAE,QADN;UAELF,KAAK,EAAE,KAFF;UAGLG,QAAQ,EAAE,EAHL;UAILC,UAAU,EAAE;QAJP,CADT;QAAA,UAOC;MAPD,EAjBF;IAAA,EADF,EA6BE,MAAC,IAAD;MAAM,KAAK,EAAE;QAAEC,QAAQ,EAAE,UAAZ;QAAwBC,SAAS,EAAE;MAAnC,CAAb;MAAA,WACE,KAAC,YAAD,oBAAkBlC,aAAlB,EADF,EAEE,KAAC,cAAD;QACE,gBAAgB,EAAEI,OAAO,GAAG+B,SAAH,GAAe1B,oBAD1C;QAEE,KAAK,EAAE,CACL2B,UAAU,CAACC,kBADN,EAEL;UAAEC,MAAM,EAAE,GAAV;UAAeC,YAAY,EAAE;QAA7B,CAFK;MAFT,EAFF;IAAA,EA7BF;EAAA,EADF;AA0CD;AAED,IAAMjB,MAAM,GAAGc,UAAU,CAACI,MAAX,CAAkB;EAC/BjB,SAAS,EAAE;IACTkB,IAAI,EAAE,CADG;IAETC,eAAe,EAAE,OAFR;IAGTC,UAAU,EAAE,EAHH;IAITnB,OAAO,EAAE;EAJA;AADoB,CAAlB,CAAf"},"metadata":{},"sourceType":"module"}